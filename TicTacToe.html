<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TicTacToe</title>
    <style>
        td { 
            border:1px solid black; width: 50px; height: 50px; 
            text-align: center; font-weight: bold; vertical-align: middle; font-size: 34px;
        }
    </style>
</head>
<body>
    <!--
    <table>
        <tr>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </table>
    -->

    <script>
        var ë°”ë”” = document.body;
        var í…Œì´ë¸” = document.createElement('í…Œì´ë¸”');
        var ì¤„ë“¤ = [];
        var ì¹¸ë“¤ = [];
        var í„´ = 'X';
        var ê²°ê³¼ = document.createElement('div');
        
        var ë¹„ë™ê¸°ì½œë°± = function(e){
            console.log(e.target); //ì´ë²¤íŠ¸ê°€ ë°œìƒëœ íƒœê·¸ : ì¹¸
            console.log(e.target.parentNode); //ì´ë²¤íŠ¸ê°€ ë°œìƒëœ íƒœê·¸ì˜ ë¶€ëª¨ : ì¤„
            console.log(e.target.parentNode.parentNode); //í…Œì´ë¸”


            //ìœ„ì¹˜ ì•Œì•„ë‚´ê¸°
            var ëª‡ì¤„ = ì¤„ë“¤.indexOf(e.target.parentNode);
            console.log('ëª‡ì¤„',ëª‡ì¤„);

            var ëª‡ì¹¸ = ì¹¸ë“¤[ëª‡ì¤„].indexOf(e.target);
            console.log('ëª‡ì¹¸',ëª‡ì¹¸);


            //Q.ì¹¸ì´ ì´ë¯¸ ì±„ì›Œì ¸ ìˆëŠ”ê°€?
            if(ì¹¸ë“¤[ëª‡ì¤„][ëª‡ì¹¸].textContent !== '') { 
                console.log('ë¹ˆì¹¸ì´ ì•„ë‹™ë‹ˆë‹¤.');
                
            } else {
                console.log('ë¹ˆì¹¸ì…ë‹ˆë‹¤.');
                ì¹¸ë“¤[ëª‡ì¤„][ëª‡ì¹¸].textContent = í„´;

                //Q.ì„¸ì¹¸ì´ ë‹¤ ì±„ì›Œì¡Œë‚˜?
                var ë‹¤ì°¸ = false;

                //1. ê°€ë¡œì¤„ê²€ì‚¬
                if(ì¹¸ë“¤[ëª‡ì¤„][0].textContent===í„´ && ì¹¸ë“¤[ëª‡ì¤„][1].textContent===í„´ && ì¹¸ë“¤[ëª‡ì¤„][2].textContent===í„´) {
                    ë‹¤ì°¸ = true;
                }

                //2. ì„¸ë¡œì¤„ê²€ì‚¬
                if(ì¹¸ë“¤[0][ëª‡ì¹¸].textContent===í„´ && ì¹¸ë“¤[1][ëª‡ì¹¸].textContent===í„´ && ì¹¸ë“¤[2][ëª‡ì¹¸].textContent===í„´) {
                    ë‹¤ì°¸ = true;
                }

                //3-1. ëŒ€ê°ì„ ê²€ì‚¬(ì¹¸ê³¼ ì¤„ì´ ê°™ì€ ìœ„ì¹˜ì˜ ë¸”ëŸ­ì¸ ê²½ìš°)
                if(ëª‡ì¤„-ëª‡ì¹¸ === 0) {
                    if(ì¹¸ë“¤[0][0].textContent===í„´ && ì¹¸ë“¤[1][1].textContent===í„´ && ì¹¸ë“¤[2][2].textContent===í„´) {
                        ë‹¤ì°¸ = true;  
                    }
                }

                //3-2. ëŒ€ê°ì„ ê²€ì‚¬
                if(Math.abs(ëª‡ì¤„-ëª‡ì¹¸) === 2 ) {
                    if(ì¹¸ë“¤[0][2].textContent===í„´ && ì¹¸ë“¤[1][1].textContent===í„´ && ì¹¸ë“¤[2][0].textContent===í„´) {
                        ë‹¤ì°¸ = true;  
                    }
                }

                //4. ë‹¤ ì°¼ìœ¼ë©´
                if(ë‹¤ì°¸ === true) {
                    ê²°ê³¼.textContent = 'í„´' + 'ë‹˜ì´ ìŠ¹ë¦¬!ğŸ‘';
                    //initalize
                    í„´ = 'X';
                    ì¹¸ë“¤.forEach(function(ì¤„){
                        ì¤„.forEach(function(ì¹¸){
                            ì¹¸.textContent = '';
                        });
                    });
                } else {
                    //ë‹¤ ì•ˆì°¼ìœ¼ë©´ í„´ì„ ë„˜ê¸´ë‹¤
                    if(í„´ === 'X') {
                        í„´ = 'O';
                    } else {
                        í„´ = 'X';
                    }
                }
            }
        };


        for(var i =0; i<3; i++){
            var ì¤„ = document.createElement('tr');
            ì¤„ë“¤.push(ì¤„);
            ì¹¸ë“¤.push([]);

            for(var j=0; j<3; j++){
                var ì¹¸ = document.createElement('td');
                //ë¹„ë™ê¸°ì½œë°±
                ì¹¸.addEventListener('click', ë¹„ë™ê¸°ì½œë°±);
                ì¹¸ë“¤[i].push(ì¹¸);
                ì¤„.appendChild(ì¹¸);
            }
            í…Œì´ë¸”.appendChild(ì¤„);
        }
        ë°”ë””.appendChild(í…Œì´ë¸”);
        ë°”ë””.appendChild(ê²°ê³¼);
        // console.log(ì¹¸ë“¤,ì¤„ë“¤);
    </script>
</body>
</html>